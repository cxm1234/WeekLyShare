# Swift-å‡½æ•°å¼ç¼–ç¨‹

## ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹

ç®€å•åœ°è¯´ï¼Œå‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå®ƒå¼ºè°ƒé€šè¿‡æ•°å­¦é£æ ¼çš„å‡½æ•°ã€ä¸å¯å˜æ€§å’Œè¡¨è¾¾æ€§è¿›è¡Œè®¡ç®—ï¼Œå¹¶å°½é‡å‡å°‘å¯¹å˜é‡å’ŒçŠ¶æ€çš„ä½¿ç”¨ã€‚
å› ä¸ºæœ‰æœ€å°çš„å…±äº«çŠ¶æ€ï¼Œæ¯ä¸ªåŠŸèƒ½å°±åƒä½ çš„åº”ç”¨æµ·æ´‹ä¸­çš„ä¸€ä¸ªå²›å±¿ï¼Œå®ƒä½¿äº‹æƒ…æ›´å®¹æ˜“æµ‹è¯•ã€‚å‡½æ•°å¼ç¼–ç¨‹ä¹‹æ‰€ä»¥æµè¡Œèµ·æ¥ï¼Œè¿˜å› ä¸ºå®ƒå¯ä»¥ä½¿å¹¶å‘å’Œå¹¶è¡Œå¤„ç†æ›´å®¹æ˜“ä½¿ç”¨ã€‚è¿™æ˜¯ä½ çš„å·¥å…·ç®±ä¸­æé«˜å¤šæ ¸è®¾å¤‡æ€§èƒ½çš„åˆä¸€ä»¶äº‹ã€‚


* æ¨¡å—åŒ–ï¼š ç›¸è¾ƒäºæŠŠç¨‹åºè®¤ä¸ºæ˜¯ä¸€ç³»åˆ—èµ‹å€¼å’Œæ–¹æ³•è°ƒç”¨ï¼Œå‡½æ•°å¼å¼€å‘è€…æ›´å€¾å‘äºå¼ºè°ƒæ¯ä¸ªç¨‹åºéƒ½èƒ½å¤Ÿè¢«åå¤åˆ†è§£ä¸ºè¶Šæ¥è¶Šå°çš„æ¨¡å—å•å…ƒï¼Œè€Œæ‰€æœ‰è¿™äº›å—å¯ä»¥é€šè¿‡å‡½æ•°è£…é…èµ·æ¥ï¼Œä»¥å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„ç¨‹åºã€‚å½“ç„¶ï¼Œåªæœ‰å½“æˆ‘ä»¬èƒ½å¤Ÿé¿å…åœ¨ä¸¤ä¸ªç‹¬ç«‹ç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€æ—¶ï¼Œæ‰èƒ½å°†ä¸€ä¸ªå¤§å‹ç¨‹åºåˆ†è§£ä¸ºæ›´å°çš„å•å…ƒã€‚è¿™å¼•å‡ºæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªå…³æ³¨ç‰¹è´¨ã€‚

* å¯¹å¯å˜çŠ¶æ€çš„è°¨æ…å¤„ç†ï¼š å‡½æ•°å¼ç¼–ç¨‹æœ‰æ—¶å€™ (è¢«åŠå¼€ç©ç¬‘åœ°) ç§°ä¸ºâ€œé¢å‘å€¼ç¼–ç¨‹â€ã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸“æ³¨äºç±»å’Œå¯¹è±¡çš„è®¾è®¡ï¼Œæ¯ä¸ªç±»å’Œå¯¹è±¡éƒ½æœ‰å®ƒä»¬è‡ªå·±çš„å°è£…çŠ¶æ€ã€‚ç„¶è€Œï¼Œå‡½æ•°å¼ç¼–ç¨‹å¼ºè°ƒåŸºäºå€¼ç¼–ç¨‹çš„é‡è¦æ€§ï¼Œè¿™èƒ½ä½¿æˆ‘ä»¬å…å—å¯å˜çŠ¶æ€æˆ–å…¶ä»–ä¸€äº›å‰¯ä½œç”¨çš„å›°æ‰°ã€‚é€šè¿‡é¿å…å¯å˜çŠ¶æ€ï¼Œå‡½æ•°å¼ç¨‹åºæ¯”å…¶å¯¹åº”çš„å‘½ä»¤å¼æˆ–è€…é¢å‘å¯¹è±¡çš„ç¨‹åºæ›´å®¹æ˜“ç»„åˆã€‚

* ç±»å‹ï¼š æœ€åï¼Œä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„å‡½æ•°å¼ç¨‹åºåœ¨ä½¿ç”¨ç±»å‹æ—¶åº”è¯¥ç›¸å½“è°¨æ…ã€‚ç²¾å¿ƒé€‰æ‹©ä½ çš„â€œæ•°æ®å’Œå‡½æ•°çš„ç±»å‹ï¼Œå°†ä¼šæœ‰åŠ©äºæ„å»ºä½ çš„ä»£ç ï¼Œè¿™æ¯”å…¶ä»–ä¸œè¥¿éƒ½é‡è¦ã€‚Swift æœ‰ä¸€ä¸ªå¼ºå¤§çš„ç±»å‹ç³»ç»Ÿï¼Œä½¿ç”¨å¾—å½“çš„è¯ï¼Œå®ƒèƒ½å¤Ÿè®©ä½ çš„ä»£ç æ›´åŠ å®‰å…¨å’Œå¥å£®ã€‚

### ä¸¾ä¸ªğŸŒ°

æ™®é€šç‰ˆæœ¬ç­›é€‰
``` swift
var evens = [Int]()
for i in 1...10 {
  if i % 2 == 0 {
    evens.append(i)
  }
}
println(evens)
```

å‡½æ•°å¼çš„åˆ é€‰
```swift
func isEven(number: Int) -> Bool {
  return number % 2 == 0
}
evens = Array(1...10).filter(isEven)
println(evens)
```
1. é€šè¿‡range1...10åˆ›å»ºä¸€ä¸ªæ•´æ•°æ•°ç»„
2. å°†isEvenå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’åˆ°filterå‡½æ•°ä¸­

æ›´ç®€æ´çš„ç‰ˆæœ¬
```swift
evens = Array(1...10).filter { (number) in number % 2 == 0 }
println(evens)
```

æ›´è¿›ä¸€æ­¥
```swift
evens = Array(1...10).filter { $0 % 2 == 0 }
println(evens)
```

## å‡½æ•°å¼è¯­è¨€ä¸€äº›æœ‰è¶£çš„ç‰¹æ€§

1. é«˜é˜¶å‡½æ•°ï¼šè¿™ç§å‡½æ•°çš„å‚æ•°ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œfilterå°±æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°
2. ä¸€çº§å‡½æ•°ï¼šä½ å¯ä»¥å°†å‡½æ•°å½“åšæ˜¯ä»»æ„å˜é‡ï¼Œå¯ä»¥å°†å®ƒä»¬èµ‹å€¼ç»™å˜é‡ï¼Œä¹Ÿå¯ä»¥å°†å®ƒä»¬ä½œä¸ºå‚æ•°ä¼ ç»™å…¶ä»–å‡½æ•°ï¼›
3. é—­åŒ…ï¼šå®é™…ä¸Šå°±æ˜¯åŒ¿åå‡½æ•°ï¼›

### é«˜é˜¶å‡½æ•°æ¢ç´¢

#### map

å‡å¦‚æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªç»™å®šçš„æ•´å‹æ•°ç»„ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°å¹¶è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œæ–°æ•°ç»„å„é¡¹ä¸ºåŸæ•°ç»„ä¸­å¯¹åº”çš„æ•´å‹æ•°æ®åŠ ä¸€ã€‚è¿™ä¸€åˆ‡ï¼Œä»…ä»…åªéœ€è¦ä½¿ç”¨ä¸€ä¸ª for å¾ªç¯å°±èƒ½éå¸¸å®¹æ˜“åœ°å®ç°ï¼š

```swift
func increment(array: [Int]) -> [Int] {
    var result: [Int] = []
    for x in array {
        result.append(x + 1)
    }
    return result
}
```

ç°åœ¨å‡è®¾æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºç”Ÿæˆä¸€ä¸ªæ¯é¡¹éƒ½ä¸ºå‚æ•°æ•°ç»„å¯¹åº”é¡¹ä¸¤å€çš„æ–°æ•°ç»„ã€‚è¿™åŒæ ·èƒ½å¾ˆå®¹æ˜“åœ°ä½¿ç”¨ä¸€ä¸ª for å¾ªç¯æ¥å®ç°ï¼š

```swift
func double(array: [Int]) -> [Int] {
    var result: [Int] = []
    for x in array {
        result.append(x * 2)
    }
    return result
}
```

è¿™ä¸¤ä¸ªå‡½æ•°æœ‰å¤§é‡ç›¸åŒçš„ä»£ç ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½å°†æ²¡æœ‰åŒºåˆ«çš„åœ°æ–¹æŠ½è±¡å‡ºæ¥ï¼Œå¹¶å•ç‹¬å†™ä¸€ä¸ªä½“ç°è¿™ç§æ¨¡å¼ä¸”æ›´é€šç”¨çš„å‡½æ•°å‘¢ï¼Ÿåƒè¿™æ ·çš„å‡½æ•°éœ€è¦è¿½åŠ ä¸€ä¸ªæ–°å‚æ•°æ¥æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‚æ•°èƒ½æ ¹æ®å„ä¸ªæ•°ç»„é¡¹è®¡ç®—å¾—åˆ°æ–°çš„æ•´å‹æ•°å€¼ï¼š

```swift
func compute(array: [Int], transform: (Int) -> Int) -> [Int] {
    var result: [Int] = []
    for x in array {
        result.append(transform(x))
    }
    return result
}
```
ä»£ç ä»ç„¶ä¸åƒæƒ³è±¡ä¸­çš„é‚£ä¹ˆçµæ´»ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦å¾—åˆ°ä¸€ä¸ªå¸ƒå°”å‹çš„æ–°æ•°ç»„ï¼Œç”¨äºè¡¨ç¤ºåŸæ•°ç»„ä¸­å¯¹åº”çš„æ•°å­—æ˜¯å¦æ˜¯å¶æ•°ã€‚æˆ‘ä»¬å¯èƒ½ä¼šå°è¯•ç¼–å†™ä¸€äº›åƒä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š
```swift
func isEven(array: [Int]) -> [Bool] {
    return compute(array: array) { $0 % 2 == 0 }
}
```
ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ®µä»£ç å¯¼è‡´äº†ä¸€ä¸ªç±»å‹é”™è¯¯ã€‚é—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬çš„ compute å‡½æ•°æ¥å—ä¸€ä¸ª (Int) -> Int ç±»å‹çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥å‚æ•°æ˜¯ä¸€ä¸ªè¿”å›æ•´å‹å€¼çš„å‡½æ•°ã€‚è€Œåœ¨ isEven å‡½æ•°çš„å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ª (Int) -> Bool ç±»å‹çš„å‚æ•°ï¼Œäºæ˜¯å¯¼è‡´äº†ç±»å‹é”™è¯¯ã€‚
æˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæ³›å‹ï¼

```swift
func genericCompute<T>(array: [Int], transform: (Int) -> T) -> [T] {
    var result: [T] = []
    for x in array {
        result.append(transform(x))
    }
    return result
}
```

æ›´è¿›ä¸€æ­¥

```swift
func map<Element, T>(_ array: [Element], transform: (Element) -> T) -> [T] {
    var result: [T] = []
    for x in array {
        result.append(transform(x))
    }
    return result
}
```
swiftæƒ¯ä¾‹ï¼š
```swift
extension Array {
    func map<T>(_ transform: (Element) -> T) -> [T] {
        var result: [T] = []
        for x in self {
            result.append(transform(x))
        }
        return result
    }
}
```

#### Filter

```swift
extension Array {
func filter(_ includeElement: (Element) -> Bool) -> [Element] {
    var result: [Element] = []
    for x in self where includeElement(x) {
        result.append(x)
    }
    return result
    }
}
```

#### Reduce

å®šä¹‰ä¸€ä¸ªè®¡ç®—æ•°ç»„ä¸­æ‰€æœ‰æ•´å‹å€¼ä¹‹å’Œçš„å‡½æ•°éå¸¸ç®€å•ï¼š
```swift
func sum(integers: [Int]) -> Int {
    var result: Int = 0
    for x in integers {
        result += x
    }
    return result
}
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼ sum ä¸­çš„ for å¾ªç¯æ¥å®šä¹‰ä¸€ä¸ª product å‡½æ•°ï¼Œç”¨äºè®¡ç®—æ‰€æœ‰æ•°ç»„é¡¹ç›¸ä¹˜ä¹‹ç§¯ï¼š
```swift
func product(integers: [Int]) -> Int {
    var result: Int = 1
    for x in integers {
        result = x * result
    }
    return result
}
```

åŒæ ·åœ°ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦è¿æ¥æ•°ç»„ä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼š
```swift
func concatenate(strings: [String]) -> String {
    var result: String = ""
    for string in strings {
        result += string
    }
    return result
}
```

æˆ–è€…è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è¿æ¥æ•°ç»„ä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶æ’å…¥ä¸€ä¸ªå•ç‹¬çš„é¦–è¡Œï¼Œä»¥åŠåœ¨æ¯ä¸€é¡¹åé¢è¿½åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ï¼š
```swift
func prettyPrint(strings: [String]) -> String {
    var result: String = "Entries in the array xs:\n"
    for string in strings {
        result = "  " + result + string + "\n"
    }
    return result
}
```

è¿™äº›å‡½æ•°æœ‰ä»€ä¹ˆå…±åŒç‚¹å‘¢ï¼Ÿå®ƒä»¬éƒ½å°†å˜é‡ result åˆå§‹åŒ–ä¸ºæŸä¸ªå€¼ã€‚éšåå¯¹è¾“å…¥æ•°ç»„çš„æ¯ä¸€é¡¹è¿›è¡Œéå†ï¼Œæœ€åä»¥æŸç§æ–¹å¼æ›´æ–°ç»“æœã€‚ä¸ºäº†å®šä¹‰ä¸€ä¸ªå¯ä»¥ä½“ç°æ‰€éœ€ç±»å‹çš„æ³›å‹å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸¤ä»½ä¿¡æ¯è¿›è¡ŒæŠ½è±¡ï¼šèµ‹ç»™ result å˜é‡çš„åˆå§‹å€¼ï¼Œå’Œç”¨äºåœ¨æ¯ä¸€æ¬¡å¾ªç¯ä¸­æ›´æ–° result çš„å‡½æ•°ã€‚

```swift
extension Array {
    func reduce<T>(_ initial: T, combine: (T, Element) -> T) -> T {
        var result = initial
        for x in self {
            result = combine(result, x)
        }
        return result
    }
}
```

â€œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ reduce æ¥å®šä¹‰æ–°çš„æ³›å‹å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„æ¯ä¸€é¡¹éƒ½æ˜¯æ•°ç»„ï¼Œè€Œæˆ‘ä»¬æƒ³å°†å®ƒå±•å¼€ä¸ºä¸€ä¸ªå•ä¸€æ•°ç»„ã€‚å¯ä»¥ä½¿ç”¨ for å¾ªç¯ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼š
```swift
func flatten<T>(_ xss: [[T]]) -> [T] {
    var result: [T] = []
    for xs in xss {
        result += xs
    }
    return result
}
```

ç„¶è€Œï¼Œè‹¥ä½¿ç”¨ reduce åˆ™å¯ä»¥åƒä¸‹é¢è¿™æ ·ç¼–å†™è¿™ä¸ªå‡½æ•°ï¼š
```swift
func flattenUsingReduce<T>(_ xss: [[T]]) -> [T] {
    return xss.reduce([]) { result, xs in result + xs }
}
```

å®é™…ä¸Šï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨ reduce é‡æ–°å®šä¹‰ map å’Œ filterï¼š

```swift
extension Array {
    func mapUsingReduce<T>(_ transform: (Element) -> T) -> [T] {
        return reduce([]) { result, x in
            return result + [transform(x)]
        }
    }

    func filterUsingReduce(_ includeElement: (Element) -> Bool) -> [Element] {
        return reduce([]) { result, x in
            return includeElement(x) ? result + [x] : result
        }
    }
}
```

## æŸ¯é‡ŒåŒ–
æœ‰ä¸¤ç§ç­‰æ•ˆçš„æ–¹å¼èƒ½å¤Ÿå®šä¹‰ä¸€ä¸ªå¯ä»¥æ¥å—ä¸¤ä¸ª (æˆ–æ›´å¤š) å‚æ•°çš„å‡½æ•°ã€‚å¯¹äºå¤§å¤šæ•°ç¨‹åºå‘˜æ¥è¯´ï¼Œåº”è¯¥ä¼šè§‰å¾—ç¬¬ä¸€ç§é£æ ¼æ›´ç†Ÿæ‚‰ï¼š

```swift
func add1(_ x: Int, _ y: Int) -> Int {
    return x + y
}
```
å¦ä¸€ä¸ªç‰ˆæœ¬

```swift
func add2(_ x: Int) -> (Int)->Int {
    return {y in x + y}
}
```
```swift
add(1,2)
add2(1)(2)
```
add1 å’Œ add2 çš„ä¾‹å­å‘æˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•å°†ä¸€ä¸ªæ¥å—å¤šå‚æ•°çš„å‡½æ•°å˜æ¢ä¸ºä¸€ç³»åˆ—åªæ¥å—å•ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºæŸ¯é‡ŒåŒ– (Currying)ï¼Œå®ƒå¾—åäºé€»è¾‘å­¦å®¶ Haskell Curryï¼›æˆ‘ä»¬å°† add2 ç§°ä¸º add1 çš„æŸ¯é‡ŒåŒ–ç‰ˆæœ¬

é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¯´æŸ¯é‡ŒåŒ–å¾ˆæœ‰è¶£å‘¢ï¼Ÿæ­£å¦‚è¿„ä»Šä¸ºæ­¢æˆ‘ä»¬åœ¨æœ¬ä¹¦ä¸­æ‰€çœ‹åˆ°çš„ï¼Œåœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³è¦å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶å®ƒå‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬æœ‰åƒ add1 ä¸€æ ·æœªæŸ¯é‡ŒåŒ–çš„å‡½æ•°ï¼Œé‚£æˆ‘ä»¬å°±å¿…é¡»åŒæ—¶ç”¨åˆ°å®ƒçš„å…¨éƒ¨ä¸¤ä¸ªå‚æ•°æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ªåƒ add2 ä¸€æ ·è¢«æŸ¯é‡ŒåŒ–äº†çš„å‡½æ•°æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šå¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–ä¸¤ä¸ªå‚æ•°æ¥è°ƒç”¨ã€‚

### æŸ¯é‡ŒåŒ–æ³›å‹ç‰ˆæœ¬

å‡½æ•°ç»„åˆè¿ç®—ç¬¦
```swift
infix operator >>>
func >>> <A, B, C>(f: @escaping (A) -> B, g: @escaping (B) -> C) -> (A) -> C {
    return { x in g(f(x)) }
}
```
è¿™ä¸ªå‡½æ•°çš„ç±»å‹æå…·é€šç”¨æ€§ï¼Œä»¥è‡³äºå®ƒå®Œå…¨å†³å®šäº†å‡½æ•°è‡ªèº«è¢«å®šä¹‰çš„å½¢å¼ã€‚è¿™é‡Œæˆ‘ä»¬ä¼šå°è¯•å¯¹æ­¤è¿›è¡Œä¸€äº›ä¸å¤ªæ­£å¼çš„è¯´æ˜å’Œè®¨è®ºã€‚
æˆ‘ä»¬éœ€è¦å¾—åˆ°çš„æ˜¯ä¸€ä¸ª C ç±»å‹çš„å€¼ã€‚ç”±äºæˆ‘ä»¬å¹¶ä¸çŸ¥é“å…¶å®ƒä»»ä½•æœ‰å…³ C çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡æœ‰èƒ½å¤Ÿè¿”å›çš„å€¼ã€‚å¦‚æœçŸ¥é“ C æ˜¯åƒ Int æˆ–è€… Bool è¿™æ ·çš„å…·ä½“ç±»å‹çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿”å›ä¸€ä¸ªè¯¥ç±»å‹çš„å€¼ï¼Œä¾‹å¦‚åˆ†åˆ«è¿”å› 5 æˆ– trueã€‚ä½†æ˜¯ç”±äºæˆ‘ä»¬çš„å‡½æ•°å¿…é¡»è¦èƒ½å¤„ç†ä»»æ„ç±»å‹çš„ Cï¼Œæ‰€ä»¥ä¸èƒ½è½»ç‡åœ°è¿”å›å…·ä½“å€¼ã€‚åœ¨ >>> è¿ç®—ç¬¦çš„å‚æ•°ä¸­ï¼Œåªæœ‰ g: (B) -> C å‡½æ•°æåŠäº†ç±»å‹ Cã€‚å› æ­¤ï¼Œå°† B ç±»å‹çš„å€¼ä¼ é€’ç»™å‡½æ•° g æ˜¯æˆ‘ä»¬èƒ½å¤Ÿè§¦åŠç±»å‹ C çš„å”¯ä¸€é€”å¾„ã€‚
åŒæ ·ï¼Œè¦å¾—åˆ°ä¸€ä¸ª B ç±»å‹å€¼çš„å”¯ä¸€æ–¹æ³•æ˜¯å°†ç±»å‹ä¸º A çš„å€¼å”¯ä¸€å‡ºç°çš„åœ°æ–¹æ˜¯åœ¨æˆ‘ä»¬è¿ç®—ç¬¦è¦æ±‚è¿”å›çš„å‡½æ•°çš„è¾“å…¥å‚æ•°é‡Œã€‚å› æ­¤ï¼Œå‡½æ•°ç»„åˆçš„å®šä¹‰åªæœ‰è¿™å”¯ä¸€ä¸€ç§å¯èƒ½ï¼Œæ‰èƒ½æ»¡è¶³æ‰€è¦æ±‚çš„æ³›å‹ç±»å‹ã€‚

```swift
func curry<A, B, C>(_ f: @escaping (A, B) -> C) -> (A) -> (B) -> C {
    return { x in { y in f(x, y) } }
}
```

## è¿­ä»£å™¨å’Œåºåˆ—

### è¿­ä»£å™¨

åœ¨ Objective-C å’Œ Swift ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨æ•°æ®ç±»å‹ Array æ¥è¡¨ç¤ºä¸€ç»„æœ‰åºå…ƒç´ ã€‚è™½ç„¶æ•°ç»„ç®€å•è€Œåˆå¿«æ·ï¼Œä½†æ€»ä¼šæœ‰å¹¶ä¸é€‚åˆç”¨æ•°ç»„æ¥è§£å†³çš„åœºæ™¯å‡ºç°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨æ€»æ•°æ¥è¿‘æ— ç©·çš„æ—¶å€™ï¼Œä½ å¯èƒ½ä¸æƒ³å¯¹æ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ è¿›è¡Œè®¡ç®—ï¼›æˆ–è€…ä½ å¹¶ä¸æƒ³ä½¿ç”¨å…¨éƒ¨çš„å…ƒç´ ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šæ›´å¸Œæœ›ä½¿ç”¨ä¸€ä¸ªè¿­ä»£å™¨æ¥ä»£æ›¿æ•°ç»„ã€‚
ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œæˆ‘ä»¬ä¼šé¦–å…ˆåˆ©ç”¨ä¸æ•°ç»„è¿ç®—ç›¸ä¼¼çš„ä¾‹å­ï¼Œä½¿ä½ è§‰å¾—è¿­ä»£å™¨æˆ–è®¸ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚
Swift çš„ for å¾ªç¯å¯ä»¥è¢«ç”¨äºè¿­ä»£æ•°ç»„å…ƒç´ ï¼š
```swift
for x in array {
// do something with x
}
```

åœ¨è¿™æ ·ä¸€ä¸ª for å¾ªç¯ä¸­ï¼Œæ•°ç»„ä¼šè¢«ä»å¤´éå†åˆ°å°¾ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ æƒ³è¦ç”¨ä¸åŒçš„é¡ºåºå¯¹æ•°ç»„è¿›è¡Œéå†å‘¢ï¼Ÿè¿™æ—¶ï¼Œè¿­ä»£å™¨å°±å¯èƒ½æ´¾ä¸Š

ä»æ¦‚å¿µä¸Šæ¥è¯´ï¼Œä¸€ä¸ªè¿­ä»£å™¨æ˜¯æ¯æ¬¡æ ¹æ®è¯·æ±‚ç”Ÿæˆæ•°ç»„æ–°å…ƒç´ çš„â€œè¿‡ç¨‹â€ã€‚ä»»ä½•ç±»å‹åªè¦éµå®ˆä»¥ä¸‹åè®®ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼š

```swift
protocol IteratorProtocol {
    associatedtype Element
    mutating func next() -> Element?
}
```
è¿™ä¸ªåè®®éœ€è¦ä¸€ä¸ªç”± IteratorProtocol å®šä¹‰çš„å…³è”ç±»å‹ï¼šElementï¼Œä»¥åŠä¸€ä¸ªç”¨äºäº§ç”Ÿæ–°å…ƒç´ çš„ next æ–¹æ³•ï¼Œå¦‚æœæ–°å…ƒç´ å­˜åœ¨å°±è¿”å›å…ƒç´ æœ¬èº«ï¼Œåä¹‹åˆ™è¿”å› nilã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹æ–‡çš„è¿­ä»£å™¨ä¼šä»æ•°ç»„çš„æœ«å°¾å¼€å§‹ç”Ÿæˆåºåˆ—å€¼ï¼Œä¸€ç›´åˆ° 0ã€‚Element çš„ç±»å‹å¯ä»¥ç”±æ–¹æ³• next æ¨æ–­å‡ºæ¥ï¼Œæˆ‘ä»¬ä¸å¿…æ˜¾å¼åœ°æŒ‡å®šï¼š
```swift
struct ReverseIndexIterator: IteratorProtocol {
    var index: Int
    init<T>(array: [T]) {
        index = array.endIndex-1
    }
    mutating func next() -> Int? {
        guard index >= 0 else { return nil }
        defer { index -= 1 }
        return index
    }
}
```

æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªè¾“å…¥å‚æ•°ä¸ºæ•°ç»„çš„æ„é€ æ–¹æ³•ï¼Œç„¶åä½¿ç”¨æ•°ç»„çš„æœ€åä¸€ä¸ªåˆæ³•åºåˆ—å€¼åˆå§‹åŒ– index ã€‚
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ReverseIndexIterator æ¥å€’åºåœ°éå†æ•°ç»„ï¼š

```swift
let letters = ["A", "B", "C"]
()
var iterator = ReverseIndexIterator(array: letters)
while let i = iterator.next() {
    print("Element \(i) of the array is \(letters[i])")
}
```

/*
 Element 2 of the array is C
 Element 1 of the array is B
 Element 0 of the array is A
*/â€

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿­ä»£å™¨å¹¶ä¸éœ€è¦ç”Ÿæˆ nil å€¼ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªè¿­ä»£å™¨ç”¨æ¥ç”Ÿæˆâ€œæ— æ•°ä¸ªâ€äºŒçš„å¹‚å€¼ (ç›´åˆ°è¯¥å€¼å˜ä¸ºæŸä¸ªæå¤§å€¼ï¼Œè‡´ä½¿ NSDecimalNumber æº¢å‡º)ï¼š
```swift
struct PowerIterator: IteratorProtocol {
    var power: NSDecimalNumber = 1
    mutating func next() -> NSDecimalNumber? {
        power = power.multiplying(by: 2)
        return power
    }
}
```

```swift
extension PowerIterator {
    mutating func find(where predicate: (NSDecimalNumber) -> Bool) -> NSDecimalNumber? {
        while let x = next() {
            if predicate(x) {
                return x
            }
        }
        return nil
    }
}
```

### åºåˆ—
è¿­ä»£å™¨ä¸º Swift å¦ä¸€ä¸ªåè®®æä¾›äº†åŸºç¡€ç±»å‹ï¼Œè¿™ä¸ªåè®®å°±æ˜¯åºåˆ—ã€‚è¿­ä»£å™¨æä¾›äº†ä¸€ä¸ªâ€œå•æ¬¡è§¦å‘â€çš„æœºåˆ¶ä»¥åå¤åœ°è®¡ç®—å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ã€‚è¿™ç§æœºåˆ¶ä¸æ”¯æŒè¿”æŸ¥æˆ–é‡æ–°ç”Ÿæˆå·²ç»ç”Ÿæˆè¿‡çš„å…ƒç´ ï¼Œæˆ‘ä»¬æƒ³è¦åšåˆ°è¿™ä¸ªçš„è¯å°±åªèƒ½å†åˆ›å»ºä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ã€‚åè®® SequenceType åˆ™ä¸ºè¿™äº›åŠŸèƒ½æä¾›äº†ä¸€ç»„åˆé€‚çš„æ¥å£ï¼š
```swift
protocol Sequence {
    associatedtype Iterator: IteratorProtocol
    func makeIterator() -> Iterator
    // ...
}
```
æ¯ä¸€ä¸ªåºåˆ—éƒ½æœ‰ä¸€ä¸ªå…³è”çš„è¿­ä»£å™¨ç±»å‹å’Œä¸€ä¸ªåˆ›å»ºæ–°è¿­ä»£å™¨çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥æ®æ­¤ä½¿ç”¨è¯¥è¿­ä»£å™¨æ¥éå†åºåˆ—ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ReverseIndexIterator å®šä¹‰ä¸€ä¸ªåºåˆ—ï¼Œç”¨äºç”ŸæˆæŸä¸ªæ•°ç»„çš„ä¸€ç³»åˆ—å€’åºåºåˆ—å€¼ï¼š
```swift
struct ReverseArrayIndices<T>: Sequence {
    let array: [T]
    init(array: [T]) {
        self.array = array
    }
    func makeIterator() -> ReverseIndexIterator {
        return ReverseIndexIterator(array: array)
    }
}
```

æ¯å½“æˆ‘ä»¬å¸Œæœ›éå† ReverseArrayIndices ç»“æ„ä½“ä¸­å­˜å‚¨çš„æ•°ç»„æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ makeIterator æ–¹æ³•æ¥ç”Ÿæˆä¸€ä¸ªéœ€è¦çš„è¿­ä»£å™¨ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•å°†ä¸Šè¿°çš„ç‰‡æ®µç»„åˆåœ¨ä¸€èµ·ï¼š

```swift
var array = ["one", "two", "three"]
let reverseSequence = ReverseArrayIndices(array: array)
var reverseIterator = reverseSequence.makeIterator()
while let i = reverseIterator.next() {
    print("Index \(i) is \(array[i])")
}
/*
 Index 2 is three
 Index 1 is two
 Index 0 is one
*/
```
Swift åœ¨å¤„ç†åºåˆ—æ—¶æœ‰ä¸€ä¸ªç‰¹åˆ«çš„è¯­æ³•ã€‚ä¸åŒäºåˆ›å»ºä¸€ä¸ªåºåˆ—çš„å…³è”è¿­ä»£å™¨ï¼Œä½ å¯ä»¥ç¼–å†™ä¸€ä¸ª for å¾ªç¯ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä»¥ä¸Šçš„ä»£ç ç‰‡æ®µå†™æˆè¿™æ ·ï¼š

```swift
for i in ReverseArrayIndices(array: array) {
    print("Index \(i) is \(array[i])")
}
/*
 Index 2 is three
 Index 1 is two
 Index 0 is one
*/
```

å®é™…ä¸Šï¼ŒSwift æ‰€åšçš„åªæ˜¯ä½¿ç”¨ makeIterator() æ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ªè¿­ä»£å™¨ï¼Œç„¶åé‡å¤åœ°è°ƒç”¨å…¶ next æ–¹æ³•ç›´åˆ°è¿”å› nilã€‚

## what's more å‡½å­ã€é€‚ç”¨å‡½å­ä¸å•å­

### å‡½å­

```swift
extension Array {
    func map<R>(transform: (Element) -> R) -> Array<R>
}
extension Optional {
    func map<R>(transform: (Wrapped) -> R) -> Optional<R>
}
extension Parser {
    func map<T>(_ transform: @escaping (Result) -> T) -> Parser<T>
}
```

Optional ä¸ Array éƒ½æ˜¯éœ€è¦ä¸€ä¸ªæ³›å‹ä½œä¸ºå‚æ•°æ¥æ„å»ºå…·ä½“ç±»å‹çš„ç±»å‹æ„é€ ä½“ (Type Constructor)ã€‚å¯¹äºä¸€ä¸ªå®ä¾‹æ¥è¯´ï¼ŒArray<T> ä¸ Optional<Int> æ˜¯åˆæ³•çš„ç±»å‹ï¼Œè€Œ Array æœ¬èº«å´å¹¶ä¸æ˜¯ã€‚æ¯ä¸ª map æ–¹æ³•éƒ½éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªå³å°†è¢«æ˜ å°„çš„æ•°æ®ç»“æ„ï¼Œå’Œä¸€ä¸ªç±»å‹ä¸º (T) -> U çš„å‡½æ•° transformã€‚å¯¹äºæ•°ç»„æˆ–å¯é€‰å€¼å‚æ•°ä¸­æ‰€æœ‰ç±»å‹ä¸º T çš„å€¼ï¼Œmap æ–¹æ³•ä¼šä½¿ç”¨ transform å°†å®ƒä»¬è½¬æ¢ä¸º Uã€‚è¿™ç§æ”¯æŒ map è¿ç®—çš„ç±»å‹æ„é€ ä½“ â€”â€” æ¯”å¦‚å¯é€‰å€¼æˆ–æ•°ç»„ â€”â€” æœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä½œå‡½å­ (Functor)ã€‚

### é€‚ç”¨å‡½å­

### å•å­























